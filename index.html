<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width" />

        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                overflow: hidden;
            }

            .desktop {
                width: 100vw;
                height: 100vh;

                display: grid;
                grid-template-rows: 1fr 0.05fr;
                grid-template-columns: 1fr;

                color-scheme: dark light;

                --_base-colour: #111;
                --_accent-colour: #fff;

                @media (prefers-color-scheme: dark) {
                    --base-colour: var(--_base-colour);
                    --accent-colour: var(--_accent-colour);
                }

                @media (prefers-color-scheme: light) {
                    --base-colour: var(--_accent-colour);
                    --accent-colour: var(--_base-colour);
                }

                background-color: var(--base-colour);
                color: var(--accent-colour);

                .grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
                    grid-template-rows: repeat(auto-fill, minmax(60px, 1fr));
                    grid-gap: 10px;
                    .icon {
                        border: 1px solid var(--accent-colour);
                        border-radius: 30%;
                    }
                }

                .taskbar {
                    display: grid;
                    grid-template-columns: 0.1fr 1fr 0.1fr;
                    grid-template-rows: 1fr;
                    border-top: 1px solid var(--accent-colour);

                    .start {
                        text-align: center;
                        color: var(--accent-colour);
                        transition: background-color 0.2s ease-out, color 0.2s ease-in;
                        padding: 0;
                        margin: 0;
                    }

                    .icon-tray {
                        background-color: var(--icon-tray-bg);
                        border-left: 1px solid var(--accent-colour);
                        border-right: 1px solid var(--accent-colour);
                        display: grid;
                        grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
                        grid-template-rows: 1fr;
                        grid-gap: 10px;
                        padding: 2px 10px;
                        .icon {
                            border: 1px solid var(--accent-colour);
                            border-radius: 30%;
                            margin: 3px;
                            aspect-ratio: 1/1;
                        }
                    }

                    .system-tray {
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        .icon {
                            border: 1px solid var(--accent-colour);
                        }

                        .radio {
                            display: flex;
                            justify-content: center;
                            align-items: center;
                            flex-direction: row;
                            padding: 5px;
                            gap: 5px;
                            &audio {
                                display: none;
                                width: 0;
                                height: 0;
                            }

                            .play_pause {
                                display: flex;
                                justify-content: center;
                                align-items: center;
                                aspect-ratio: 1/1;
                                margin: 0 10px;
                                cursor: pointer;
                                color: var(--accent-colour);
                            }
                        }

                        .volume {
                            -webkit-appearance: none;
                            appearance: none;
                            width: 12px;
                            height: 5px;
                            border-radius: 5px;
                            background: var(--accent-colour);
                            outline: none;
                            transition: width 0.2s;
                            cursor: pointer;

                            &:hover,
                            &:focus {
                                width: 80px;
                            }
                        }

                        .time {
                            color: var(--accent-colour);
                            font-size: 0.8rem;
                            margin: 0 10px;
                        }
                    }
                }

                .window {
                    border-radius: 30px;
                    resize: both;
                    overflow: auto;
                    position: absolute;

                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);

                    min-width: 300px;
                    min-height: 300px;
                    max-width: 80vw;
                    max-height: 80vh;
                    height: 80vh;
                    width: 80vw;

                    display: grid;
                    grid-template-rows: 0.1fr 1fr;
                    grid-template-columns: 1fr;

                    border: 1px solid var(--accent-colour);

                    .title-bar {
                        border-bottom: 1px solid var(--accent-colour);
                        display: grid;
                        grid-template-columns: 0.1fr 1fr 0.1fr;
                        grid-template-rows: 1fr;
                        align-items: center;
                        justify-items: center;
                        padding: min(5px, 1vh) min(10px, 2vh);
                        .title-text {
                            color: var(--accent-colour);
                            font-size: 1.2rem;
                            white-space: nowrap;
                        }

                        .padding {
                            width: 100%;
                            height: 100%;
                        }

                        .button-container {
                            display: flex;
                            flex-direction: row;
                            justify-content: center;
                            align-items: center;
                            & div {
                                aspect-ratio: 1/1;
                                min-width: 1.5rem;
                                color: #fff;
                                padding: 2px;
                                margin: 2px;
                                border: 1px solid var(--accent-colour);
                                border-radius: 30%;
                                display: flex;
                                justify-content: center;
                                align-items: center;
                                cursor: pointer;
                            }
                        }
                        .content {
                            width: 100%;
                            height: 100%;
                        }
                    }
                }
            }
        </style>

        <script>
            function playPause(btn) {
                let audio = document.querySelector("audio");
                if (audio.paused) {
                    audio.play();
                    btn.classList.remove("fa-play");
                    btn.classList.add("fa-pause");
                } else {
                    audio.pause();
                    btn.classList.remove("fa-pause");
                    btn.classList.add("fa-play");
                }
            }

            function setVolume(volumeValue) {
                let audio = document.querySelector("audio");
                audio.volume = volumeValue / 100;
            }

            class CustomWindow extends HTMLElement {
                constructor(title) {
                    super();
                    this.createWindow(title);
                }

                createWindow(title) {
                    const window = document.createElement("div");
                    window.classList.add("window");

                    const titleBar = this.createDivWithClass("title-bar");
                    titleBar.style.cursor = "move";
                    const titleText = this.createDivWithClass("title-text");
                    titleText.innerHTML = title;

                    const buttonContainer = this.createDivWithClass("button-container");
                    const minimizeButton = this.createDivWithClass("minimize-button");
                    minimizeButton.innerHTML = "-";
                    minimizeButton.addEventListener("click", () => window.classList.toggle("minimized"));
                    const closeButton = this.createDivWithClass("close-button");
                    closeButton.innerHTML = "X";
                    closeButton.addEventListener("click", () => window.remove());
                    buttonContainer.append(minimizeButton, closeButton);

                    const content = document.createElement("iframe");
                    content.style.width = "100%";
                    content.style.height = "100%";
                    content.style.border = "none";
                    content.src = "https://devdocs.io/";

                    titleBar.append(titleText, document.createElement("div"), buttonContainer);
                    window.append(titleBar, content);
                    this.appendChild(window);

                    this.makeDraggable(window, titleBar);
                }

                createDivWithClass(className) {
                    const div = document.createElement("div");
                    div.classList.add(className);
                    return div;
                }

                makeDraggable(element, handle) {
                    let offsetX = 0,
                        offsetY = 0,
                        mouseX = 0,
                        mouseY = 0;
                    handle.onmousedown = dragMouseDown;

                    function dragMouseDown(e) {
                        e.preventDefault();
                        mouseX = e.clientX;
                        mouseY = e.clientY;
                        document.onmouseup = closeDragElement;
                        document.onmousemove = elementDrag;
                    }

                    function elementDrag(e) {
                        e.preventDefault();
                        offsetX = mouseX - e.clientX;
                        offsetY = mouseY - e.clientY;
                        mouseX = e.clientX;
                        mouseY = e.clientY;
                        element.style.top = element.offsetTop - offsetY + "px";
                        element.style.left = element.offsetLeft - offsetX + "px";
                    }

                    function closeDragElement() {
                        document.onmouseup = null;
                        document.onmousemove = null;
                    }
                }
            }

            // Register the custom element
            customElements.define("custom-window", CustomWindow);

            // Usage
            document.addEventListener("DOMContentLoaded", function () {
                const desktop = document.querySelector(".desktop");
                const window1 = new CustomWindow("My Computer");
                const window2 = new CustomWindow("My Computer");
                desktop.appendChild(window1);
                desktop.appendChild(window2);
            });
        </script>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />

        <title>Desktop</title>
    </head>
    <body>
        <div class="desktop">
            <div class="grid"></div>
            <div class="taskbar">
                <div class="start">
                    <h3>Start</h3>
                </div>
                <div class="icon-tray"></div>
                <div class="system-tray">
                    <div class="radio">
                        <audio controls style="display: none;">
                            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg" />
                        </audio>
                        <i class="play_pause fa fa-play" onclick="playPause(this)"></i>
                        <input type="range" min="0" max="100" value="100" class="volume" onchange="setVolume(this.value)" />
                    </div>
                    <p class="time">12:00</p>
                </div>
            </div>
        </div>
    </body>
</html>
